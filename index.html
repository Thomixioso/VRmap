<html>
  <head>
    <meta charset="utf-8">
    <title>180° SBS Stereo Layers FIX</title>
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <script>
      AFRAME.registerComponent('stereo-sbs-180', {
        schema: {src: {type: 'asset'}},
        init: function () {
          const sceneEl = this.el.sceneEl;
          const renderer = sceneEl.renderer;
          const texture = new THREE.TextureLoader().load(this.data.src);
          texture.minFilter = THREE.LinearFilter;

          // Levé oko
          const matLeft = new THREE.MeshBasicMaterial({map: texture, side: THREE.BackSide});
          matLeft.map.repeat.set(0.5, 1);
          matLeft.map.offset.set(0, 0);

          // Pravé oko
          const matRight = new THREE.MeshBasicMaterial({map: texture, side: THREE.BackSide});
          matRight.map.repeat.set(0.5, 1);
          matRight.map.offset.set(0.5, 0);

          // Geometrie 180° polokoule
          const geom = new THREE.SphereGeometry(10, 64, 64, 0, Math.PI);

          // Mesh pro levé oko
          const meshLeft = new THREE.Mesh(geom, matLeft);
          meshLeft.rotation.y = Math.PI; // otočení 180° kolem Y
          meshLeft.layers.set(1); // vrstva levého oka

          // Mesh pro pravé oko
          const meshRight = new THREE.Mesh(geom, matRight);
          meshRight.rotation.y = Math.PI;
          meshRight.layers.set(2); // vrstva pravého oka

          // Přidáme je přímo do THREE.Scene uvnitř A-Frame
          sceneEl.object3D.add(meshLeft);
          sceneEl.object3D.add(meshRight);

          console.log("Stereo 180° SBS inicializováno.");
        }
      });
    </script>
  </head>
  <body>
    <a-scene vr-mode-ui="enabled: true" xr-webxr="referenceSpaceType: local" background="color: black">
      <!-- aktivace komponenty -->
      <a-entity stereo-sbs-180="src: ./Castles/generated/Le_Castillet_generated.jpg"></a-entity>
    </a-scene>
  </body>
</html>

