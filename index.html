<!DOCTYPE html>
<html>
<head>
    <title>A-Frame Stereo - Insta 360 EVO</title>
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <script src="build.js"></script>
</head>
<body>
    <a-scene antialias="true">
        <!-- Rozdělené poloviny z Insta 360 EVO obrázku -->
        <a-assets>
            <img id="originalImage" src="./Castles/generated/Le_Castillet_generated.jpg">
            <canvas id="left" width="1024" height="1024"></canvas>
            <canvas id="right" width="1024" height="1024"></canvas>
        </a-assets>

        <!-- Camera -->
        <a-entity camera look-controls position="0 0 0" stereocam="eye:left;"></a-entity>

        <!-- Sky sphere pouze pro 180° (přední hemisféra) -->
        <a-sky id="sky1" src="#left" stereo="eye:left" 
               geometry="primitive: sphere; radius: 10; thetaStart: 0; thetaLength: 180; phiStart: 0; phiLength: 360"
               material="side: back"></a-sky>
        <a-sky id="sky2" src="#right" stereo="eye:right"
               geometry="primitive: sphere; radius: 10; thetaStart: 0; thetaLength: 180; phiStart: 0; phiLength: 360" 
               material="side: back"></a-sky>
    </a-scene>

    <script>
        // Rozdělení side-by-side obrázku na dva canvas
        window.addEventListener('load', () => {
            const img = document.getElementById('originalImage');
            
            img.onload = () => {
                const leftCanvas = document.getElementById('left');
                const rightCanvas = document.getElementById('right');
                
                const fullWidth = img.naturalWidth;
                const fullHeight = img.naturalHeight;
                const halfWidth = fullWidth / 2;
                
                leftCanvas.width = halfWidth;
                leftCanvas.height = fullHeight;
                rightCanvas.width = halfWidth;
                rightCanvas.height = fullHeight;
                
                const leftCtx = leftCanvas.getContext('2d');
                const rightCtx = rightCanvas.getContext('2d');
                
                // Levá polovina → left canvas
                leftCtx.drawImage(img, 0, 0, halfWidth, fullHeight, 0, 0, halfWidth, fullHeight);
                
                // Pravá polovina → right canvas
                rightCtx.drawImage(img, halfWidth, 0, halfWidth, fullHeight, 0, 0, halfWidth, fullHeight);
            };
            
            if (img.complete) img.onload();
        });
    </script>
</body>
</html>
