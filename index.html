<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Mapa zaj√≠mav√Ωch m√≠st</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 20px;
    background-color: #f5f5f5;
  }
  
  .container {
    max-width: 1200px;
    margin: 0 auto;
    background: white;
    border-radius: 10px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    overflow: hidden;
  }
  
  .header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 20px;
    text-align: center;
  }
  
  .stats {
    padding: 15px;
    background: #f8f9fa;
    border-bottom: 1px solid #dee2e6;
    text-align: center;
  }
  
  .stat-item {
    display: inline-block;
    margin: 0 15px;
    padding: 5px 10px;
    background: white;
    border-radius: 5px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  }
  
  #map { 
    height: 65vh; 
    width: 100%; 
  }
  
  #imageContainer { 
    padding: 20px;
    text-align: center;
    min-height: 250px;
    background: #f8f9fa;
  }
  
  #imageContainer img { 
    max-width: 100%; 
    max-height: 400px;
    height: auto; 
    border: 2px solid #dee2e6;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  }
  
  .location-info {
    background: white;
    padding: 20px;
    margin: 10px auto;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    max-width: 600px;
  }
  
  .coordinates {
    color: #6c757d;
    font-size: 0.9em;
    margin: 10px 0;
    font-family: monospace;
    background: #f1f1f1;
    padding: 5px 8px;
    border-radius: 3px;
    display: inline-block;
  }
  
  .category-badge {
    display: inline-block;
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 0.8em;
    font-weight: bold;
    color: white;
    margin: 5px 0;
  }
  
  .error-message {
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
    padding: 15px;
    border-radius: 5px;
    margin: 20px;
  }
  
  .loading {
    text-align: center;
    padding: 40px;
    color: #6c757d;
  }
  
  /* Vlastn√≠ styly pro markery */
  .custom-marker {
    background: transparent;
    border: none;
  }
  
  /* Animace pro markery */
  .leaflet-marker-icon {
    transition: transform 0.2s ease-in-out;
  }
  
  .leaflet-marker-icon:hover {
    transform: scale(1.1);
    z-index: 1000;
  }
</style>
</head>
<body>

<div class="container">
  <div class="header">
    <h1>üó∫Ô∏è Mapa zaj√≠mav√Ωch m√≠st</h1>
    <p>Interaktivn√≠ prohl√≠≈æeƒç lokac√≠ s fotografiemi</p>
  </div>
  
  <div class="stats" id="stats">
    <div class="loading">üìç Naƒç√≠t√°m data...</div>
  </div>
  
  <div id="map"></div>
  
  <div id="imageContainer">
    <div class="location-info">
      <h3>V√≠tejte!</h3>
      <p>Kliknƒõte na libovoln√Ω marker na mapƒõ pro zobrazen√≠ detail≈Ø a fotografie m√≠sta.</p>
    </div>
  </div>
</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
let map;
let allLocations = [];

// Inicializace mapy
function initMap() {
  map = L.map('map').setView([49.75, 15.5], 7);
  {
  // R≈Øzn√© styly map - odkomentujte ten, kter√Ω chcete pou≈æ√≠t:

	 // Satelitn√≠ podklad
   L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
    attribution: 'Imagery &copy; Esri'
   }).addTo(map);
 
 // P≈ôekryvn√° vrstva s popisky mƒõst a silnicemi
    L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}', {
     attribution: ' | Labels &copy; Esri'
    }).addTo(map);
  }






  // 1. Standardn√≠ OpenStreetMap (v√Ωchoz√≠)
  /* 
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; OpenStreetMap contributors'
  }).addTo(map);
  */
  
  // 2. Tmav√Ω styl - odkomentujte pro tmavou mapu
  /*
  L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
    attribution: '&copy; OpenStreetMap contributors &copy; CARTO'
  }).addTo(map);
  */
  
  // 3. Satelitn√≠ sn√≠mky - odkomentujte pro satelitn√≠ pohled
  /*
  L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
    attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community'
  }).addTo(map);
  */
  
  // 4. Svƒõtl√Ω minimalistick√Ω styl - odkomentujte pro ƒçist√Ω vzhled
  /*
  L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
    attribution: '&copy; OpenStreetMap contributors &copy; CARTO'
  }).addTo(map);
  */
  
  // 5. Topografick√° mapa - odkomentujte pro ter√©nn√≠ mapu
  /*
  L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
    attribution: 'Map data: &copy; OpenStreetMap contributors, SRTM | Map style: &copy; OpenTopoMap'
  }).addTo(map);
  */
}

// Naƒçten√≠ dat z JSON souboru
async function loadData() {
  try {
    const response = await fetch('data.json');
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}: ${response.statusText}`);
    }
    
    const data = await response.json();
    allLocations = data;
    
    if (allLocations.length === 0) {
      showError('JSON soubor neobsahuje ≈æ√°dn√° data');
      return;
    }
    
    displayStats();
    addMarkersToMap();
    fitMapToMarkers();
    
  } catch (error) {
    showError(`Chyba p≈ôi naƒç√≠t√°n√≠ dat: ${error.message}<br><br>
      <strong>Mo≈æn√© p≈ô√≠ƒçiny:</strong><br>
      ‚Ä¢ Soubor 'data.json' neexistuje<br>
      ‚Ä¢ Neplatn√Ω JSON form√°t<br>
      ‚Ä¢ Probl√©m se s√≠≈•ov√Ωm p≈ôipojen√≠m`);
  }
}

// Zobrazen√≠ statistik
function displayStats() {
  const categories = {};
  allLocations.forEach(loc => {
    categories[loc.category] = (categories[loc.category] || 0) + 1;
  });
  
  const categoryStats = Object.entries(categories)
    .map(([cat, count]) => `<span class="stat-item"><strong>${cat}:</strong> ${count}</span>`)
    .join('');
  
  document.getElementById('stats').innerHTML = `
    <div style="margin-bottom: 10px;">
      <span class="stat-item"><strong>Celkem m√≠st:</strong> ${allLocations.length}</span>
    </div>
    <div>${categoryStats}</div>
  `;
}

// P≈ôid√°n√≠ marker≈Ø na mapu
function addMarkersToMap() {
  allLocations.forEach(location => {
    if (!location.lat || !location.lon) return;
    
    // Vlastn√≠ ikona podle kategorie
    const customIcon = createCustomIcon(location.category);
    const marker = L.marker([location.lat, location.lon], { icon: customIcon });
    
    // Popup s z√°kladn√≠mi informacemi
    marker.bindPopup(`
      <div style="text-align: center; min-width: 200px;">
        <h4 style="margin: 5px 0; color: ${getCategoryColor(location.category)};">${location.name}</h4>
        <div class="category-badge" style="background: ${getCategoryColor(location.category)};">
          ${location.category}
        </div>
        <br>
        <small style="color: #666;">
          ${location.lat.toFixed(4)}, ${location.lon.toFixed(4)}
        </small>
        <br><br>
        <small><em>Kliknƒõte na marker pro detail</em></small>
      </div>
    `);
    
    // Kliknut√≠ na marker
    marker.on('click', () => {
      displayLocationDetails(location);
    });
    
    marker.addTo(map);
  });
}

// Vytvo≈ôen√≠ vlastn√≠ ikony podle kategorie
function createCustomIcon(category) {
  const color = getCategoryColor(category);
  const icon = getCategoryIcon(category);
  
  return L.divIcon({
    className: 'custom-marker',
    html: `
      <div style="
        background: ${color};
        width: 30px;
        height: 30px;
        border-radius: 50% 50% 50% 0;
        transform: rotate(-45deg);
        border: 3px solid white;
        box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
      ">
        <span style="
          transform: rotate(45deg);
          color: white;
          font-size: 14px;
          font-weight: bold;
        ">${icon}</span>
      </div>
    `,
    iconSize: [30, 30],
    iconAnchor: [15, 30]
  });
}

// Ikony podle kategori√≠
function getCategoryIcon(category) {
  const icons = {
    'Castles': 'üè∞',
    'Churches': '‚õ™',
    'Museums': 'üèõÔ∏è',
    'Parks': 'üå≥',
    'Monuments': 'üóø',
    'Historic': 'üìú',
    'default': 'üìç'
  };
  return icons[category] || icons.default;
}

// P≈ôizp≈Øsoben√≠ mapy v≈°em marker≈Øm
function fitMapToMarkers() {
  if (allLocations.length === 0) return;
  
  const coords = allLocations
    .filter(loc => loc.lat && loc.lon)
    .map(loc => [loc.lat, loc.lon]);
  
  if (coords.length > 0) {
    const group = L.featureGroup(coords.map(coord => L.marker(coord)));
    map.fitBounds(group.getBounds().pad(0.05));
  }
}

// Z√≠sk√°n√≠ barvy podle kategorie
function getCategoryColor(category) {
  const colors = {
    'Castles': '#8B4513',
    'Churches': '#4169E1',
    'Museums': '#32CD32', 
    'Parks': '#228B22',
    'Monuments': '#FFD700',
    'Historic': '#DDA0DD',
    'default': '#FF6347'
  };
  return colors[category] || colors.default;
}

// Zobrazen√≠ detail≈Ø lokace
function displayLocationDetails(location) {
  const container = document.getElementById('imageContainer');
  
  // Kontrola existence obr√°zku
  const img = new Image();
  img.onload = function() {
    container.innerHTML = `
      <div class="location-info">
        <h3>üìç ${location.name}</h3>
        <div class="category-badge" style="background: ${getCategoryColor(location.category)};">
          ${location.category}
        </div>
        <div class="coordinates">
          GPS: ${location.lat.toFixed(6)}, ${location.lon.toFixed(6)}
        </div>
        ${location.description ? `<p><em>${location.description}</em></p>` : ''}
        <img src="${location.image}" alt="${location.name}">
      </div>
    `;
  };
  
  img.onerror = function() {
    container.innerHTML = `
      <div class="location-info">
        <h3>üìç ${location.name}</h3>
        <div class="category-badge" style="background: ${getCategoryColor(location.category)};">
          ${location.category}
        </div>
        <div class="coordinates">
          GPS: ${location.lat.toFixed(6)}, ${location.lon.toFixed(6)}
        </div>
        ${location.description ? `<p><em>${location.description}</em></p>` : ''}
        <div style="padding: 20px; background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 5px; margin: 10px 0;">
          <p>‚ö†Ô∏è Obr√°zek se nepoda≈ôilo naƒç√≠st</p>
          <small style="font-family: monospace; word-break: break-all;">${location.image}</small>
        </div>
      </div>
    `;
  };
  
  img.src = location.image;
}

// Zobrazen√≠ chyby
function showError(message) {
  document.getElementById('stats').innerHTML = `
    <div class="error-message">
      <h4>‚ùå Chyba p≈ôi naƒç√≠t√°n√≠</h4>
      <p>${message}</p>
    </div>
  `;
}

// Inicializace p≈ôi naƒçten√≠ str√°nky
document.addEventListener('DOMContentLoaded', function() {
  initMap();
  loadData();
});
</script>

</body>
</html>
